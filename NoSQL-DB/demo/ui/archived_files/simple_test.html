<!DOCTYPE html>
<html>
<head>
    <title>Simple Test</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>Simple Counter Test</h1>
    
    <h2>Raw API Response:</h2>
    <div id="raw-data" style="background: #f0f0f0; padding: 10px; white-space: pre-wrap; font-family: monospace;"></div>
    
    <h2>Node Counters:</h2>
    <div id="counters" style="background: #e0e0e0; padding: 10px;"></div>
    
    <script>
        console.log('Simple test starting...');
        
        function updateData() {
            console.log('Fetching data...');
            
            fetch('/api/real/twitter/active_tweets')
                .then(response => {
                    console.log('Response received:', response.status);
                    return response.json();
                })
                .then(data => {
                    console.log('Data:', data);
                    
                    // Show raw data
                    document.getElementById('raw-data').textContent = JSON.stringify(data, null, 2);
                    
                    if (data.success && data.tweets && data.tweets.length > 0) {
                        const firstTweet = data.tweets[0];
                        console.log('First tweet:', firstTweet);
                        
                        // Get stats for first tweet
                        fetch('/api/twitter/stats/' + firstTweet.tweet_id)
                            .then(response => response.json())
                            .then(statsData => {
                                console.log('Stats:', statsData);
                                
                                let html = '<h3>Tweet: ' + firstTweet.tweet_id + '</h3>';
                                
                                Object.keys(statsData).forEach(nodeKey => {
                                    const node = statsData[nodeKey];
                                    html += '<div style="border: 1px solid #ccc; margin: 10px; padding: 10px;">';
                                    html += '<h4>' + nodeKey + ' (' + node.address + ')</h4>';
                                    
                                    if (node.counters) {
                                        html += 'Likes: ' + (node.counters.likes || 0) + '<br>';
                                        html += 'Retweets: ' + (node.counters.retweets || 0) + '<br>';
                                        html += 'Comments: ' + (node.counters.comments || 0) + '<br>';
                                        html += 'Views: ' + (node.counters.views || 0) + '<br>';
                                    } else {
                                        html += 'No data on this node<br>';
                                    }
                                    
                                    html += '</div>';
                                });
                                
                                document.getElementById('counters').innerHTML = html;
                            })
                            .catch(error => {
                                console.error('Stats error:', error);
                                document.getElementById('counters').innerHTML = 'Error getting stats: ' + error;
                            });
                    } else {
                        document.getElementById('counters').innerHTML = 'No tweets found';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('raw-data').textContent = 'Error: ' + error;
                    document.getElementById('counters').innerHTML = 'Error: ' + error;
                });
        }
        
        // Update immediately
        updateData();
        
        // Update every 5 seconds
        setInterval(updateData, 5000);
        
        console.log('Simple test ready');
    </script>
</body>
</html>