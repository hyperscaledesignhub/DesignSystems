{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import LoginForm from'./components/LoginForm';import RegisterForm from'./components/RegisterForm';import SimpleDashboard from'./components/SimpleDashboard';// Set axios defaults\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";axios.defaults.baseURL='/api';function App(){const[user,setUser]=useState(null);const[currentView,setCurrentView]=useState('login');const[loading,setLoading]=useState(true);useEffect(()=>{checkAuth();},[]);const checkAuth=async()=>{const token=localStorage.getItem('token');if(token){try{axios.defaults.headers.common['Authorization']=\"Bearer \".concat(token);const response=await axios.get('/validate');if(response.data.valid){setUser(response.data.user);}else{localStorage.removeItem('token');delete axios.defaults.headers.common['Authorization'];}}catch(error){console.error('Auth check failed:',error);localStorage.removeItem('token');delete axios.defaults.headers.common['Authorization'];}}setLoading(false);};const handleLogin=async(email,password)=>{try{const response=await axios.post('/login',{email,password});const{access_token,user:userData}=response.data;localStorage.setItem('token',access_token);axios.defaults.headers.common['Authorization']=\"Bearer \".concat(access_token);setUser(userData);return{success:true};}catch(error){var _error$response,_error$response$data;console.error('Login failed:',error);return{success:false,message:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Login failed'};}};const handleRegister=async(email,password,name)=>{try{const response=await axios.post('/register',{email,password,full_name:name,role:'user'});const{access_token,user:userData}=response.data;localStorage.setItem('token',access_token);axios.defaults.headers.common['Authorization']=\"Bearer \".concat(access_token);setUser(userData);return{success:true};}catch(error){var _error$response2,_error$response2$data;console.error('Registration failed:',error);return{success:false,message:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||'Registration failed'};}};const handleLogout=()=>{localStorage.removeItem('token');delete axios.defaults.headers.common['Authorization'];setUser(null);setCurrentView('login');};if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh'},children:/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"})});}if(user){return/*#__PURE__*/_jsx(SimpleDashboard,{user:user,onLogout:handleLogout});}return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'100vh',backgroundColor:'#f5f5f5'},children:/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'white',padding:'2rem',borderRadius:'8px',boxShadow:'0 2px 10px rgba(0,0,0,0.1)',width:'100%',maxWidth:'400px'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:'center',marginBottom:'2rem',color:'#333'},children:\"Email System\"}),currentView==='login'?/*#__PURE__*/_jsx(LoginForm,{onLogin:handleLogin,onSwitchToRegister:()=>setCurrentView('register')}):/*#__PURE__*/_jsx(RegisterForm,{onRegister:handleRegister,onSwitchToLogin:()=>setCurrentView('login')})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","LoginForm","RegisterForm","SimpleDashboard","jsx","_jsx","jsxs","_jsxs","defaults","baseURL","App","user","setUser","currentView","setCurrentView","loading","setLoading","checkAuth","token","localStorage","getItem","headers","common","concat","response","get","data","valid","removeItem","error","console","handleLogin","email","password","post","access_token","userData","setItem","success","_error$response","_error$response$data","message","detail","handleRegister","name","full_name","role","_error$response2","_error$response2$data","handleLogout","style","display","justifyContent","alignItems","height","children","onLogout","minHeight","backgroundColor","padding","borderRadius","boxShadow","width","maxWidth","textAlign","marginBottom","color","onLogin","onSwitchToRegister","onRegister","onSwitchToLogin"],"sources":["/Users/vijayabhaskarv/python-projects/venv/sysdesign/17-DistriEmailServie/demo/ui/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport LoginForm from './components/LoginForm';\nimport RegisterForm from './components/RegisterForm';\nimport SimpleDashboard from './components/SimpleDashboard';\n\n// Set axios defaults\naxios.defaults.baseURL = '/api';\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [currentView, setCurrentView] = useState('login');\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      try {\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n        const response = await axios.get('/validate');\n        if (response.data.valid) {\n          setUser(response.data.user);\n        } else {\n          localStorage.removeItem('token');\n          delete axios.defaults.headers.common['Authorization'];\n        }\n      } catch (error) {\n        console.error('Auth check failed:', error);\n        localStorage.removeItem('token');\n        delete axios.defaults.headers.common['Authorization'];\n      }\n    }\n    setLoading(false);\n  };\n\n  const handleLogin = async (email, password) => {\n    try {\n      const response = await axios.post('/login', { email, password });\n      const { access_token, user: userData } = response.data;\n      \n      localStorage.setItem('token', access_token);\n      axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;\n      setUser(userData);\n      \n      return { success: true };\n    } catch (error) {\n      console.error('Login failed:', error);\n      return { \n        success: false, \n        message: error.response?.data?.detail || 'Login failed' \n      };\n    }\n  };\n\n  const handleRegister = async (email, password, name) => {\n    try {\n      const response = await axios.post('/register', { \n        email, \n        password, \n        full_name: name,\n        role: 'user'\n      });\n      const { access_token, user: userData } = response.data;\n      \n      localStorage.setItem('token', access_token);\n      axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;\n      setUser(userData);\n      \n      return { success: true };\n    } catch (error) {\n      console.error('Registration failed:', error);\n      return { \n        success: false, \n        message: error.response?.data?.detail || 'Registration failed' \n      };\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    delete axios.defaults.headers.common['Authorization'];\n    setUser(null);\n    setCurrentView('login');\n  };\n\n  if (loading) {\n    return (\n      <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh' }}>\n        <div>Loading...</div>\n      </div>\n    );\n  }\n\n  if (user) {\n    return <SimpleDashboard user={user} onLogout={handleLogout} />;\n  }\n\n  return (\n    <div style={{ \n      display: 'flex', \n      justifyContent: 'center', \n      alignItems: 'center', \n      minHeight: '100vh',\n      backgroundColor: '#f5f5f5'\n    }}>\n      <div style={{\n        backgroundColor: 'white',\n        padding: '2rem',\n        borderRadius: '8px',\n        boxShadow: '0 2px 10px rgba(0,0,0,0.1)',\n        width: '100%',\n        maxWidth: '400px'\n      }}>\n        <h1 style={{ textAlign: 'center', marginBottom: '2rem', color: '#333' }}>\n          Email System\n        </h1>\n        \n        {currentView === 'login' ? (\n          <LoginForm \n            onLogin={handleLogin}\n            onSwitchToRegister={() => setCurrentView('register')}\n          />\n        ) : (\n          <RegisterForm\n            onRegister={handleRegister}\n            onSwitchToLogin={() => setCurrentView('login')}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}